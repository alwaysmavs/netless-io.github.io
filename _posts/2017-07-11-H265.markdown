---
layout:     post
title:      "H.265 相关的知识"
subtitle:   "苹果都在提及的H.265，到底是什么样的技术"
date:       2017-07-11 14:00:00
author:     "beings"
header-img: "https://ohuuyffq2.qnssl.com/H.265.jpg"
header-mask: 0.3
catalog:    true
tags:
    - 流媒体
    - 编码
---


昨日苹果 WWDC 上反复提起 H.265 相关的内容，让很多非编解码领域的吃瓜群众开始关心起这个技术来。大多数人最关心的是，这项技术会对未来的音视频领域产生怎么样的影响，以及自己相关的业务会不会因此发生变革。

所以今天对编解码相关的细节不展开赘述，只说其在应用上相关的内容。

## H.265 编码到底是什么？

引用维基百科：高效率视频编码（High Efficiency Video Coding，简称 HEVC）是一种视频压缩标准，被视为是 ITU-T H.264/MPEG-4 AVC 标准的继任者。HEVC 被认为不仅提升视频质量，同时也能达到 H.264/MPEG-4 AVC 两倍之压缩率（等同于同样画面质量下比特率减少到了 50%），可支持 4K 分辨率甚至到超高清电视（UHDTV），最高分辨率可达到 8192×4320（8 K 分辨率）。

简单的说，H.265 是一种新的视频压缩标准，核心价值是在有限带宽下传输更高质量的网络视频，仅需原先的一半左右带宽即可播放相同质量的视频。这意味着付出同样的带宽成本下，用户可以享受到更高品质的音视频服务。

## H.265 对直播和点播平台有什么意义？

由于 H.265 高压缩率的特点，使得大多数的直播和点播平台都非常关心其发展进度。如果 H.265 能在自家的业务中广泛使用，就可以节省成本、提高用户体验，以及有效地和竞争对手拉开差距占领市场。


## 可即使 H.265 拥有着绝对优势，现在市面上主流的编码压缩标准还是 H.264，这是怎么回事？

首先，这是因为 H.265 的编码复杂度更高所以功耗更大，耗时更长。

其实这个也很好理解，打个比方说：你捏住一块海绵，如果你想压的更小就要花更大的力气捏的更紧。同理，编码压缩的时候你想压缩率更高，那么压缩的算法就要更加复杂，对设备性能的要求也就更高，单位时间内的功耗就更大。

其次，H.265 的编码复杂度的上升，让其解码也更加复杂，就目前而言，市面大多数播放器都没有专门针对 H.265 进行兼容。

最后，必须要提到浏览器对 H.265 解码的不支持，多少音视频客户来说就意味着分享获取传播获取新用户的方法就被堵上了。

这不是一个简单的技术问题，这是一个标准的问题。目前市面上的所有主流的浏览器都不支持 H.265 的解码，换句话说，你的 APP 录制或者直播推流的视频是不能通过分享到朋友圈观看，也不可以在网页上观看。

## 面对这么多问题，难道没有解决方案吗？

上面我们说到，H.265 的编解码非常消耗性能，从硬件上来说就是能让 GPU 做的事情就不要让 CPU 去做，即能硬编的就不要用软编。其实苹果本身支持 H.265 的硬编，而在后续版本的 iOS 11 中，他们会把这项能力开放给所有开发者。这意味着，iOS 平台已经大半只脚迈入了 H.265 的时代。

但是对于那些面向所有普通用户的直播和点播平台来说，只有 iOS 支持 H.265 是不够的。大家开门做生意，总不能要求每一个客户都按自己意愿选择移动设备。所以 H.265 要进一步普及就一定要支持软编码，也就是用 CPU 进行 H.265 编码，而且要把功耗控制在正常的范围以内。

目前七牛直播云的 H.265 方案就支持 iOS 和 Android 双平台的软编码，测试结果表示功耗基本和 H.264 软编码近似。

七牛云还提供服务端转码方案。简单的说，就是七牛云提供 H.265 和 H.264 互转的服务。比如你采用 H.265 录制了一段高清的短视频且上传到了七牛云。这时候服务端会将这段短视频转码出一份 H.264 文件，那么用户在 native 调用播放时候就采用七牛云的 H.265 编码的文件，在浏览器调用的时候就采用 H.264 编码的文件。直播场景下的实时互转，七牛云也马上会推出服务。

而针对播放器对 H.265 解码问题，七牛云推出一款完全自研的高性能播放器，且对 H.265 做了专门的优化兼容。

## H.265 前景预测

整体上来说，我认为 H.265 的前景十分明朗，被大规模普及只是时间问题。因为它基本拥有各种得天独厚的条件。

第一是：巨头的支持，苹果在 WWDC 上反复提到 H.265 至少说明了苹果的态度。全世界上亿的苹果设备都会成为 H.265 普及的因素。

第二是：音视频公司的推动，因为 H.265 的普及直接关系到很多音视频业务公司相关的利润。想象一下，如果是大几个 T 的带宽按 50% 节省，多出来一大笔利润很可能让一些直播点播公司扭亏为盈。

第三是：由于硬件设备的升级更新速度较快，手机 PC 等硬件的性能进一步提升会导致 H.265 性能要求过高的缺点慢慢被克服。

第四是：富媒体的升级，如 VR、AR 等次世代媒体的快速发展。而这些媒体对单位带宽内传输的信息量要求比传统媒体更高。

